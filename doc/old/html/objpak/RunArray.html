<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ascii">
<title>runarray Specification Sheet</title>
</head>
<body>
<h1>runarray Specification Sheet</h1>

<hr>
Portable Object Compiler (c) 1997,98,99,03.  All Rights Reserved.<p>
</p>
<h1>RunArray</h1>
<b>Inherits from:</b> Cltn<p>
<b>Maturity Index:</b> Experimental</p>
<p>
</p>
<h2>Class Description</h2>
This class is used by the <b>Text</b> class, to associate lists of <b>TextAttribute</b> instances, to segments of characters in a string (slices of text with the same formatting properties, called <i>runs</i>).<p>
</p>
<h2>Accessing</h2>
A <b>RunArray</b> is <i>not</i> indexed by segment number.<p>
Rather, it is indexed by character offsets : the message <b>at:</b> or <b>runLengthAt:</b> takes a character offset as argument, and translates this offset to a segment offset (the segment to which the character belongs) and returns the attributes or segment length, for that segment.</p>
<p>
The <b>size</b> of a <b>RunArray</b> is the largest character offset plus one;it is not the number of segments.</p>
<p>
</p>
<h2>Method types</h2>
<h3><b>Creation</b></h3>
<ul>
<li><a href="#2">new</a></li>
<li><a href="#3">free</a></li>
</ul>
<h3><b>Accessing</b></h3>
<ul>
<li><a href="#4">values</a></li>
<li><a href="#5">runs</a></li>
<li><a href="#7">at:</a></li>
<li><a href="#8">runLengthAt:</a></li>
<li><a href="#9">size</a></li>
<li><a href="#14">addAttribute:from:size:</a></li>
<li><a href="#16">at:insert:count:</a></li>
<li><a href="#17">deleteFrom:to:</a></li>
<li><a href="#18">concat:</a></li>
<li><a href="#19">coalesce</a></li>
</ul>
<h3><b>Printing</b></h3>
<ul>
<li><a href="#20">printOn:</a></li>
</ul>
<h2>Methods</h2>
<h3><a name="2">new</a></h3>
<blockquote>+<b>new</b>
</blockquote>
Creates an empty RunArray collection.<p>
</p>
<h3><a name="3">free</a></h3>
<blockquote>-<b>free</b>
</blockquote>
<h3><a name="4">values</a></h3>
<blockquote>-<b>values</b>
</blockquote>
Returns a collection of OrdCltn instances (each element being a list of <b>TextAttribute</b> instances).<p>
</p>
<h3><a name="5">runs</a></h3>
<blockquote>-<b>runs</b>
</blockquote>
Returns the run array (array of <i>int</i>).<p>
</p>
<h3><a name="7">at:</a></h3>
<blockquote>-<b>at</b>:(unsigned)<i>i</i>
</blockquote>
Returns a collection of TextAttributes for the <i>i</i>-th character.<p>
This method translates a character offset into a segment number.  The segment number is cached so that a subsequent call to <b>at:</b> or <b>runLengthAt:</b> doesn't have to recompute it.</p>
<p>
</p>
<h3><a name="8">runLengthAt:</a></h3>
<blockquote>- (unsigned)<b>runLengthAt</b>:(unsigned)<i>i</i>
</blockquote>
Returns the number of remaining characters in the string segment to which the character at position <i>i</i> belongs.  If <i>i</i> is the first character of a run, this method returns the size of the run.  Otherwise it returns the size minus the index of character in the run.<p>
</p>
<h3><a name="9">size</a></h3>
<blockquote>- (unsigned)<b>size</b>
</blockquote>
Returns the size of the RunArray, which is the same as the size of the String instance for this RunArray object.<p>
The number of runs can be obtained by sending a <b>size</b> message to the object returned by <b>values</b>.</p>
<p>
</p>
<h3><a name="14">addAttribute:from:size:</a></h3>
<blockquote>-<b>addAttribute</b>:<i>attrib</i><b>from</b>:(unsigned)<i>p</i><b>size</b>:(unsigned)<i>s</i>
</blockquote>
Adds <i>attrib</i> to the attribute lists for the <i>s</i> characters from position <i>p</i>.<p>
<b>Note:</b> This method is optimized for adding at the end of the RunArray.</p>
<p>
</p>
<h3><a name="16">at:insert:count:</a></h3>
<blockquote>-<b>at</b>:(unsigned)<i>anOffset</i><b>insert</b>:(char*)<i>aString</i><b>count</b>:(int)<i>n</i>
</blockquote>
<h3><a name="17">deleteFrom:to:</a></h3>
<blockquote>-<b>deleteFrom</b>:(unsigned)<i>p</i><b>to</b>:(unsigned)<i>q</i>
</blockquote>
<h3><a name="18">concat:</a></h3>
<blockquote>-<b>concat</b>:<i>b</i>
</blockquote>
<h3><a name="19">coalesce</a></h3>
<blockquote>-<b>coalesce</b>
</blockquote>
Merges adjacent lists of TextAttribute instances, by testing whether they are equal (in the sense of <b>TextAttribute</b>'s <b>isEqual</b> method).<p>
</p>
<h3><a name="20">printOn:</a></h3>
<blockquote>-<b>printOn</b>:(IOD)<i>aFile</i>
</blockquote>
Prints the RunArray values.<p></p>
</body>
</html>
